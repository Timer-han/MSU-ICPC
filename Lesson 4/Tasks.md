MSU Autumn 2022 Contest 4 Easy

# A. Без героев
ограничение по времени на тест: 1 s.
ограничение по памяти на тест: 256 MB
вводstandard input
выводstandard output
Даны два массива, a и b. Нужно добиться следующего: mini(ai)≥maxj(bj). Для этого можно сколько угодно раз выполнять следующую операцию с массивами a и b: уменьшить или увеличить любой элемент любого массива на 1. Операцию можно применять несколько раз к одним и тем же элементам.

Входные данные
Два натуральных числа через пробел — n, m (1≤n,m≤105). Во второй строке записано n целых чисел через пробел — элементы массива a (1≤ai≤109). В третьей строке записано m целых чисел через пробел — элементы массива b (1≤bi≤109).

Выходные данные
Выведите единственное целое число — минимальное количество операций, необходимых для достижения указанного выше соотношения.

Примеры
входные данные 
2 2
2 3
3 5
выходные данные 
3
входные данные 
3 2
1 2 3
3 4
выходные данные 
4
входные данные 
3 2
4 5 6
1 2
выходные данные 
0
Примечание
В первом тестовом примере можно увеличить a1 на 1 и уменьшить b2 на 1, затем снова уменьшить b2 на 1. Теперь массив a выглядит так [3; 3], массив b выглядит так [3; 3]. Наименьший элемент a не меньше наибольшего элемента b. За меньшее количество операций — не получится.

В примере 3 не надо выполнять никаких операций, условие удовлетворено изначально.


# B. Эстонский бензин
ограничение по времени на тест: 1 секунда
ограничение по памяти на тест: 256 мегабайт
ввод: стандартный ввод
вывод: стандартный вывод
Леша очень любит эстонский бензин, поэтому, поступив на КТ, он решил в свободное время заняться производством вариаций этой легендарной жидкости.

Всего у Леши есть n ингредиентов, i-й из которых имеет мощность ai. А еще у него есть m замечательных идей того, какие ингредиенты стоит использовать, чтобы результат обладал высоким качеством.

Идея номер i описывается двумя числами li и ri — ограничениями на мощность ингредиентов. Реализуя эту идею, Леша будет использовать ингредиенты с мощностями x и y (это может быть один и тот же ингредиент) такие, что li≤x≤y≤ri. Качество полученного бензина при этом оценивается как y−x.

Для каждой Лешиной идеи определите, какого максимального качества бензина он может достичь с заданными ограничениями. Если для данных li и ri не существует ни одного подходящего ингредиента, считайте качество результата равным нулю.

Входные данные
В первой строке дано целое число n — количество ингредиентов (1≤n≤105).

Во второй строке через пробел перечислены n целых чисел ai — мощности ингредиентов (−109≤ai≤109).

В третьей строке задается число m — количество идей (1≤m≤105), после чего в i-й из m следующих строк через пробел даны два числа li и ri — ограничения на мощности используемых в рамках этой идеи ингредиентов (−109≤li,ri≤109).

Выходные данные
Для каждой Лешиной идеи (li,ri) выведите в отдельной строке максимальную разность между мощностями ингредиентов, лежащими в диапазоне от li до ri включительно, или «0» (без кавычек), если подходящих ингредиентов нет.

Примеры
входные данные 
5
5 1 13 4 7
4
5 8
3 10
-1 150
1 10
выходные данные 
2
3
12
6
входные данные 
3
1 2 3
3
1 2
2 3
1 3
выходные данные 
1
1
2
входные данные 
10
100 -34 -56 22 78 -79 41 9 35 89
5
4 77
-100 100
-51 10
33 67
-98 -79
выходные данные 
32
179
43
6
0


# C. След
ограничение по времени на тест: 2 s.
ограничение по памяти на тест: 256 MB
вводstandard input
выводstandard output
Зададим следующую функцию f(x):
f(x)={x2x−1если x четноеиначе 
Заметим, что при применении многократно к любому v функции f, (для числа v вычисляем f(v), потом применяем функцию f к числу f(v) и т.д.), в конечном счёте мы получим 1. Запомним промежуточные значения на пути от v до 1 и назовем их следом: trace(v). Например, trace(1)=[1], trace(15)=[15,14,7,6,3,2,1], trace(32)=[32,16,8,4,2,1].

Выпишем все trace(x) для всех x от 1 до n. Вам необходимо определить максимальное число m такое, что m встречается хотя бы в k различных trace(x).

Иначе говоря, нужно найти такое максимальное y, что |{x | 1≤x≤n,y∈trace(x)}|≥k.

Входные данные
В первой строке следуют два целых числа n и k (1≤k≤n≤1018).

Выходные данные
Выведите максимальное число m такое, что m встречается хотя бы в k различных trace(x).

Примеры
входные данные 
11 3
выходные данные 
5
входные данные 
11 6
выходные данные 
4
входные данные 
20 20
выходные данные 
1
входные данные 
14 5
выходные данные 
6
входные данные 
1000000 100
выходные данные 
31248
Примечание
В первом примере ответ равен 5, так как 5 встретится в trace(5), в trace(10) и в trace(11).

Во втором примере ответ равен 4, так как 4 встретится в trace(4), в trace(5), в trace(8), в trace(9), в trace(10) и в trace(11).

В третьем примере n=k, поэтому ответ равен 1, так как 1 это единственное число, содержащееся в путях всех чисел от 1 до 20.


# D. Поиск ближнего
ограничение по времени на тест: 1 секунда
ограничение по памяти на тест: 256 мегабайт
ввод: стандартный ввод
вывод: стандартный вывод
Даны два массива a размера n и b размера k. Для каждого bi найти такое aj что |aj−bi|→min. Если таких aj несколько, вывести минимальное.

Входные данные
В первой строке два числа N и K (1≤N,K≤105). Во второй строке N чисел массива a, отсортированного по неубыванию, а в третьей строке – K чисел массива b.

|ai|≤2⋅109, |bi|≤2⋅109
Выходные данные
Выведите K строк по одному числу – ответ для очередного bi.

Пример
входные данные 
5 5
1 3 5 7 9
2 4 8 1 6
выходные данные 
1
3
7
1
5


# E. Найм юнитов
ограничение по времени на тест: 3 s.
ограничение по памяти на тест: 256 MB
вводstandard input
выводstandard output
Русский кот Шлёпа играет в компьютерную игру "Герои меча и магии". В начале каждого дня Шлёпа зарабатывает ровно один золотой.

В игре есть n типов существ. Каждое существо каждого типа стоит 2 монеты обычно — и 1 монету, когда этот тип на распродаже. Шлёпа хочет купить ровно ki существ i-го типа (он покупает существ в конце дня).

Шлёпа может купить любое (возможно, нулевое) количество существ любых типов в течение любого дня (конечно, если ему хватает золота, чтобы это сделать). Если тип существ, который он хочет купить, находится на распродаже, он может купить существо этого типа за 1 золотой, иначе — за 2 золотых.

У Шлёпы есть список, в какие из m дней случаются какие-либо распродажи. j-я запись в списке (dj,tj) означает, что существа tj-го типа находятся на распродаже в течение dj-го дня.

Шлёпа хочет купить всех существ как можно раньше. Ваша задача — найти минимальный номер дня, когда он сможет купить всех желаемых существ.

Входные данные
Первая строка входных данных содержит два целых числа n и m (1≤n,m≤2⋅105) — количество типов существ и количество записей в списке.

Вторая строка входных данных содержит n целых чисел k1,k2,…,kn (0≤ki≤2⋅105), где ki означает количество существ i-го типа, которое Шлёпа хочет купить. Гарантируется, что сумма всех ki не меньше 1 и не больше 2⋅105.

Следующие m строк содержат записи о распродажах. j-я из этих строк содержит j-ю запись. Она задана в виде пары целых чисел (dj,tj) (1≤dj≤2⋅105,1≤tj≤n) и означает, что сушества tj-го типа находятся на распродаже в течение dj-го дня.

Выходные данные
Выведите одно целое число — минимальный номер дня, когда Шлёпа сможет купить всех существ, которых он хочет.

Примеры
входные данные 
5 6
1 2 0 2 0
2 4
3 3
1 5
1 2
1 5
2 3
выходные данные 
8
входные данные 
5 3
4 2 1 3 2
3 5
4 2
2 5
выходные данные 
20


# F. Расстояние
ограничение по времени на тест: 2 секунды
ограничение по памяти на тест: 512 мегабайт
ввод: стандартный ввод
вывод: стандартный вывод
Given an integer array a of length n and integer k.

Define function f(S, i), where S⊂{0,1,…,n−1}, and 0≤i<n, as f(S, i)=∑j∈S|ai−aj|.

For each i print f(Si, i)→min where i∉Si and |Si|=k.

Входные данные
The first line contains integers n and k (2≤n≤3⋅105, 1≤k<n).

The second line contains n integers ai (1≤ai≤109).

Выходные данные
Print n integers, i-th of them should be minimal possible value of f(Si, i).

Примеры
входные данные 
4 2
1 2 3 4
выходные данные 
3 2 2 3
входные данные 
5 3
3 2 5 1 2
выходные данные 
4 2 8 4 2
входные данные 
6 2
3 2 1 101 102 103
выходные данные 
3 2 3 3 2 3
Примечание
First example:

i=0: S0={1,2}; f({1,2}, 0)=|1−2|+|1−3|=3.

i=1: S1={0,2}; f({0,2}, 1)=|2−1|+|2−3|=2.

i=2: S2={1,3}; f({1,3}, 2)=|3−2|+|3−4|=2.

i=3: S3={1,2}; f({1,2}, 3)=|4−2|+|4−3|=3.
